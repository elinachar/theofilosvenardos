<%= form_for @wedding_album do |f| %>
  <% if wedding_album.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(wedding_album.errors.count, "error") %> prohibited this wedding_album from being saved:</h2>

      <ul>
      <% wedding_album.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="wedding-album-translations">
    <%= f.fields_for :wedding_album_translations do |wedding_album_translation| %>
      <%= render 'wedding_album_translation_fields', f: wedding_album_translation %>
    <% end %>
  </div>

  <div class="field with-border">
    <%= f.label :wedding_on %>
    <%= f.date_select :wedding_on,  class: 'form-control' %>
  </div>

  <div class="field cover-photo with-border">
    <% if @wedding_album.photo? %>
      <p>Cover photo</p>
      <div class="row uploaded-cover-photo">
        <div class="col-3 col-md-2">
          <%= image_tag( @wedding_album.photo.url.to_s , class: "img-fluid", alt: @wedding_album.photo.url.to_s) %>
        </div>
        <div class="col-7 col-md-10">
          <p><b>Uploaded photo:</b> <%= @wedding_album.photo %></p>
          <label>
            <%= f.check_box :remove_photo %>
            Delete uploaded cover photo
          </label>
        </div>
      </div><br/>
      <%= f.label :photo, "<span><b>Replace</b> cover photo</span>".html_safe %>
    <% else %>
      <%= f.label :photo, "Cover photo" %>
    <% end %>
    <%= f.file_field :photo %>

  </div>

  <div class="field with-border">
    <% if @wedding_album.photo_square? %>
      <p>Header (square) photo</p>
      <div class="row uploaded-cover-photo">
        <div class="col-3 col-md-2">
          <%= image_tag( @wedding_album.photo_square.url.to_s , class: "img-fluid", alt: @wedding_album.photo_square.url.to_s) %>
        </div>
        <div class="col-7 col-md-10">
          <p><b>Uploaded photo:</b> <%= @wedding_album.photo_square %></p>
          <label>
            <%= f.check_box :remove_photo_square %>
            Delete uploaded header photo
          </label>
        </div>
      </div><br/>
      <%= f.label :photo_square, "<span><b>Replace</b> header (square) photo</span>".html_safe %>
    <% else %>
      <%= f.label :photo_square, "Header (square) photo" %>
    <% end %>
    <%= f.file_field :photo_square %>
  </div>

  <div class="wedding-photos">
    <div class="wedding-photos-show">
      <p>Wedding Photos</p>
        <% if @wedding_album.persisted? and @wedding_album.wedding_photos.count > 0 %>
          <div class="row">
            <p class="col-2"><strong>Preview</strong></p>
            <p class="col-3 display-md"><strong>Photo name</strong></p>
            <p class="col-7 col-md-5"><strong>Replace photo</strong></p>
            <p class="col-1 col-md-2" style><strong>Delete photo</strong></p>
          </div>
        <% end %>
        <%= f.fields_for :wedding_photos do |wedding_photo| %>
          <%= render 'wedding_photo_fields', f: wedding_photo %>
        <% end %>
    </div>

    <div class="links">
      <%= link_to_add_association 'Add Photo', f, :wedding_photos, class: "btn", data: { association_insertion_node: ".wedding-photos-show", association_insertion_method: :append } %>
    </div>
  </div>

  <div class="actions">
    <% if @wedding_album.persisted? %>
      <%= f.submit "Update wedding album", class: "btn" %>
      <%= link_to "Cancel editing", @wedding_album, class: "btn", data: { confirm: "Editing will be canceled. No changes will be saved. Are you sure?"} %>

    <% else %>
      <%= f.submit "Create wedding album", class: "btn" %>
      <%= link_to "Cancel", wedding_albums_path, class: "btn", data: { confirm: "Editing will be canceled. No changes will be saved. Are you sure?"} %>
    <% end %>
  </div>
<% end %>
